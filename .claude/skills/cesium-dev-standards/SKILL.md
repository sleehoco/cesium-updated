# CesiumCyber Development Standards

This skill enforces coding standards and best practices for the CesiumCyber Next.js project based on established patterns.

## Core Principles

### 1. NO CLAUDE ATTRIBUTION
**CRITICAL**: Never add Claude Code attribution to commits or code.
- ‚ùå NEVER add "ü§ñ Generated with [Claude Code]" to commits
- ‚ùå NEVER add "Co-Authored-By: Claude <noreply@anthropic.com>" to commits
- ‚ùå NEVER add AI-generated comments or attribution in code
- ‚úÖ All commits should appear as if written by the development team

### 2. TypeScript Strict Mode Compliance
**All code must pass TypeScript strict mode checks:**

#### Process.env Access
Always use bracket notation for `process.env` access:
```typescript
// ‚ùå WRONG
const apiKey = process.env.GROQ_API_KEY;

// ‚úÖ CORRECT
const apiKey = process.env['GROQ_API_KEY'];
```

#### Null/Undefined Checks
Add proper checks for potentially undefined values:
```typescript
// ‚ùå WRONG
const item = array[Math.floor(Math.random() * array.length)];
doSomething(item.property); // TypeScript error: possibly undefined

// ‚úÖ CORRECT
const item = array[Math.floor(Math.random() * array.length)];
if (!item) return;
doSomething(item.property);
```

### 3. ESLint Compliance
**All code must pass ESLint checks:**

#### React/JSX Rules
Escape apostrophes in JSX text:
```tsx
// ‚ùå WRONG
<p>We'll respond within 24 hours</p>

// ‚úÖ CORRECT
<p>We&apos;ll respond within 24 hours</p>
```

Remove unused imports and variables:
```typescript
// ‚ùå WRONG
import { Bot, Lock, Shield } from 'lucide-react'; // Bot and Lock unused

// ‚úÖ CORRECT
import { Shield } from 'lucide-react';
```

Prefix unused function parameters with underscore:
```typescript
// ‚ùå WRONG
services.map((service, index) => { // index unused
  return <Card key={service.id}>...</Card>
})

// ‚úÖ CORRECT - Option 1: Remove unused param
services.map((service) => {
  return <Card key={service.id}>...</Card>
})

// ‚úÖ CORRECT - Option 2: Prefix with underscore if needed
services.map((service, _index) => {
  return <Card key={service.id}>...</Card>
})
```

### 4. Environment Variables

#### Required Environment Variables
```bash
# AI Services (Required for AI Security Co-Pilot)
TOGETHER_API_KEY=
GROQ_API_KEY=
OPENAI_API_KEY=

# Threat Intelligence
VIRUSTOTAL_API_KEY=

# Email Service
RESEND_API_KEY=

# Supabase
NEXT_PUBLIC_SUPABASE_URL=
NEXT_PUBLIC_SUPABASE_ANON_KEY=
SUPABASE_SERVICE_ROLE_KEY=

# Application
NEXT_PUBLIC_APP_URL=http://localhost:3000
NODE_ENV=development
```

#### Environment Variable Access Pattern
Always use bracket notation and include proper error handling:
```typescript
// API Provider Pattern
export function getAIClient(provider: AIProvider) {
  switch (provider) {
    case 'groq':
      if (!process.env['GROQ_API_KEY']) {
        throw new Error('GROQ_API_KEY is not set');
      }
      return new Groq({
        apiKey: process.env['GROQ_API_KEY'],
      });
  }
}
```

### 5. Git Commit Standards

#### Commit Message Format
```
Fix TypeScript error in next.config.ts

Use bracket notation for process.env index signature access
```

**Rules:**
- First line: Brief summary (imperative mood)
- Blank line
- Detailed description (if needed)
- NO emojis (unless user explicitly requests)
- NO Claude attribution
- NO "Generated by" comments

#### Before Committing
1. Run type checking: `npm run build`
2. Check for linting errors
3. Verify no secrets in commit
4. Review diff for unintended changes

### 6. Code Organization

#### File Structure
```
src/
‚îú‚îÄ‚îÄ app/                    # Next.js App Router pages
‚îÇ   ‚îú‚îÄ‚îÄ api/               # API routes
‚îÇ   ‚îú‚îÄ‚îÄ tools/             # AI tools pages
‚îÇ   ‚îî‚îÄ‚îÄ [page]/            # Individual pages
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îú‚îÄ‚îÄ shared/            # Shared components
‚îÇ   ‚îî‚îÄ‚îÄ ui/                # shadcn/ui components
‚îú‚îÄ‚îÄ lib/
‚îÇ   ‚îú‚îÄ‚îÄ ai/                # AI integration
‚îÇ   ‚îú‚îÄ‚îÄ threat-intel/      # Security tools
‚îÇ   ‚îî‚îÄ‚îÄ env.ts             # Environment validation
‚îî‚îÄ‚îÄ styles/                # Global styles
```

#### Import Order
```typescript
// 1. External packages
import { useState } from 'react';
import { Card } from '@/components/ui/card';

// 2. Internal utilities
import { env } from '@/lib/env';

// 3. Types
import type { AIProvider } from '@/lib/ai/providers';
```

### 7. Component Patterns

#### Server Components (Default)
```typescript
// app/page.tsx
export default function HomePage() {
  return <main>...</main>;
}
```

#### Client Components
```typescript
// Mark with 'use client' only when needed
'use client';

import { useState } from 'react';

export default function InteractivePage() {
  const [state, setState] = useState();
  return <div>...</div>;
}
```

### 8. API Route Pattern

```typescript
// app/api/example/route.ts
import { NextRequest, NextResponse } from 'next/server';
import { z } from 'zod';

const schema = z.object({
  field: z.string().min(1),
});

export async function POST(req: NextRequest) {
  try {
    const body = await req.json();
    const validated = schema.parse(body);

    // Process request

    return NextResponse.json({ success: true });
  } catch (error) {
    if (error instanceof z.ZodError) {
      return NextResponse.json(
        { error: 'Invalid input', details: error.errors },
        { status: 400 }
      );
    }

    return NextResponse.json(
      { error: 'Internal server error' },
      { status: 500 }
    );
  }
}
```

### 9. Security Best Practices

#### API Keys
- NEVER commit `.env.local` to git
- Always check `.gitignore` includes `.env*.local`
- Use environment validation with Zod
- Provide `.env.local.example` with placeholders

#### Input Validation
```typescript
// Always validate user input
import { z } from 'zod';

const userInput = z.object({
  email: z.string().email(),
  message: z.string().min(10).max(2000),
}).parse(data);
```

#### Sensitive Data
```typescript
// Use server-side only for API keys
// Mark with ! if you've verified it exists
const apiKey = process.env['VIRUSTOTAL_API_KEY']!;

// Or handle gracefully
if (!process.env['VIRUSTOTAL_API_KEY']) {
  return null; // or throw error
}
```

### 10. Styling Standards

#### Tailwind Classes
```tsx
// Use design system colors
<div className="bg-cyber-dark text-cesium">

// Responsive design
<div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3">

// Brutalist aesthetic (no rounded corners unless specific design)
<Card className="rounded-none border-2 border-cesium/30">
```

#### Custom Theme
```typescript
// tailwind.config.ts
colors: {
  cesium: '#D4AF37',        // Gold
  cyber: {
    dark: '#0a0a0a',
    DEFAULT: '#1a1a1a',
    light: '#2a2a2a',
  }
}
```

### 11. Testing Standards

#### Test File Location
```
src/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îî‚îÄ‚îÄ page.tsx
‚îî‚îÄ‚îÄ test/
    ‚îî‚îÄ‚îÄ setup.ts          # Global test setup
```

#### Test Environment Setup
```typescript
// src/test/setup.ts
import '@testing-library/jest-dom';
import { afterEach, vi } from 'vitest';
import { cleanup } from '@testing-library/react';

afterEach(() => {
  cleanup();
});

// Mock environment
process.env['NODE_ENV'] = 'test';
```

### 12. Performance Optimization

#### Next.js Image
```tsx
import Image from 'next/image';

<Image
  src="/team/member.jpg"
  alt="Team Member"
  width={400}
  height={400}
  className="object-cover"
/>
```

#### Dynamic Imports
```typescript
// For heavy components
const HeavyComponent = dynamic(() => import('./HeavyComponent'), {
  loading: () => <LoadingSpinner />,
});
```

## Pre-Commit Checklist

Before every commit:
- [ ] Code passes TypeScript strict mode
- [ ] No ESLint errors
- [ ] No unused imports or variables
- [ ] All `process.env` uses bracket notation
- [ ] No hardcoded secrets
- [ ] No Claude attribution
- [ ] Commit message follows format
- [ ] No emojis (unless requested)

## Deployment Workflow

### Staging
```bash
git checkout staging
git add .
git commit -m "Description of changes"
git push origin staging
```

### Production
```bash
git checkout main
git pull origin main
git merge staging
git push origin main
```

## Common Fixes

### Fix TypeScript process.env Error
```typescript
// Find all: process.env.VARIABLE_NAME
// Replace: process.env['VARIABLE_NAME']
```

### Fix ESLint Apostrophe Error
```tsx
// Find all: '
// In JSX text, replace with: &apos;
```

### Fix "Possibly Undefined" Error
```typescript
// Add null check
const item = array[index];
if (!item) return; // or handle error
// Now safe to use item
```

## Architecture Decisions

### AI Provider Pattern
- Multi-provider support (Groq, Together.ai, OpenAI)
- Priority-based fallback
- Centralized error handling
- Type-safe API clients

### State Management
- React Query for server state
- useState for local component state
- Context only when necessary

### Form Handling
- Client components with useState
- Zod for validation
- Loading/error states
- Success feedback

## File-Specific Guidelines

### `next.config.ts`
- Use bracket notation for all env access
- Enable experimental features explicitly
- Configure optimization settings

### `playwright.config.ts`
- Use bracket notation for env access
- Configure for CI/CD
- Set appropriate timeouts

### API Routes
- Always validate input with Zod
- Return typed responses
- Handle errors gracefully
- Use proper HTTP status codes

## Resources

- TypeScript: https://www.typescriptlang.org/tsconfig#strict
- Next.js 15: https://nextjs.org/docs
- Tailwind: https://tailwindcss.com/docs
- shadcn/ui: https://ui.shadcn.com

---

**Last Updated:** December 1, 2025
**Maintained By:** CesiumCyber Development Team
